"use strict";
var _a, _b, _c, _d;
Object.defineProperty(exports, "__esModule", { value: true });
exports.HttpRouteIntegration = exports.HttpIntegration = exports.PayloadFormatVersion = exports.HttpConnectionType = exports.IntegrationCredentials = exports.HttpIntegrationSubtype = exports.HttpIntegrationType = void 0;
const jsiiDeprecationWarnings = require("../../.warnings.jsii.js");
const JSII_RTTI_SYMBOL_1 = Symbol.for("jsii.rtti");
const core_1 = require("@aws-cdk/core");
const apigatewayv2_generated_1 = require("../apigatewayv2.generated");
/**
 * Supported integration types
 */
var HttpIntegrationType;
(function (HttpIntegrationType) {
    /**
     * Integration type is an HTTP proxy.
     *
     * For integrating the route or method request with an HTTP endpoint, with the
     * client request passed through as-is. This is also referred to as HTTP proxy
     * integration. For HTTP API private integrations, use an HTTP_PROXY integration.
     *
     * @see https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-develop-integrations-http.html
     */
    HttpIntegrationType["HTTP_PROXY"] = "HTTP_PROXY";
    /**
     * Integration type is an AWS proxy.
     *
     * For integrating the route or method request with a Lambda function or other
     * AWS service action. This integration is also referred to as a Lambda proxy
     * integration.
     *
     * @see https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-develop-integrations-aws-services.html
     * @see https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-develop-integrations-lambda.html
     */
    HttpIntegrationType["AWS_PROXY"] = "AWS_PROXY";
})(HttpIntegrationType = exports.HttpIntegrationType || (exports.HttpIntegrationType = {}));
/**
 * Supported integration subtypes
 * @see https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-develop-integrations-aws-services-reference.html
 */
var HttpIntegrationSubtype;
(function (HttpIntegrationSubtype) {
    /**
     * EventBridge PutEvents integration
     */
    HttpIntegrationSubtype["EVENTBRIDGE_PUT_EVENTS"] = "EventBridge-PutEvents";
    /**
     * SQS SendMessage integration
     */
    HttpIntegrationSubtype["SQS_SEND_MESSAGE"] = "SQS-SendMessage";
    /**
     * SQS ReceiveMessage integration,
     */
    HttpIntegrationSubtype["SQS_RECEIVE_MESSAGE"] = "SQS-ReceiveMessage";
    /**
     * SQS DeleteMessage integration,
     */
    HttpIntegrationSubtype["SQS_DELETE_MESSAGE"] = "SQS-DeleteMessage";
    /**
     * SQS PurgeQueue integration
     */
    HttpIntegrationSubtype["SQS_PURGE_QUEUE"] = "SQS-PurgeQueue";
    /**
     * AppConfig GetConfiguration integration
     */
    HttpIntegrationSubtype["APPCONFIG_GET_CONFIGURATION"] = "AppConfig-GetConfiguration";
    /**
     * Kinesis PutRecord integration
     */
    HttpIntegrationSubtype["KINESIS_PUT_RECORD"] = "Kinesis-PutRecord";
    /**
     * Step Functions StartExecution integration
     */
    HttpIntegrationSubtype["STEPFUNCTIONS_START_EXECUTION"] = "StepFunctions-StartExecution";
    /**
     * Step Functions StartSyncExecution integration
     */
    HttpIntegrationSubtype["STEPFUNCTIONS_START_SYNC_EXECUTION"] = "StepFunctions-StartSyncExecution";
    /**
     * Step Functions StopExecution integration
     */
    HttpIntegrationSubtype["STEPFUNCTIONS_STOP_EXECUTION"] = "StepFunctions-StopExecution";
})(HttpIntegrationSubtype = exports.HttpIntegrationSubtype || (exports.HttpIntegrationSubtype = {}));
/**
 * Credentials used for AWS Service integrations.
 */
class IntegrationCredentials {
    /**
     * Use the specified role for integration requests
     */
    static fromRole(role) {
        return { credentialsArn: role.roleArn };
    }
    /** Use the calling user's identity to call the integration */
    static useCallerIdentity() {
        return { credentialsArn: 'arn:aws:iam::*:user/*' };
    }
}
exports.IntegrationCredentials = IntegrationCredentials;
_a = JSII_RTTI_SYMBOL_1;
IntegrationCredentials[_a] = { fqn: "@aws-cdk/aws-apigatewayv2.IntegrationCredentials", version: "1.159.0" };
/**
 * Supported connection types
 */
var HttpConnectionType;
(function (HttpConnectionType) {
    /**
     * For private connections between API Gateway and resources in a VPC
     */
    HttpConnectionType["VPC_LINK"] = "VPC_LINK";
    /**
     * For connections through public routable internet
     */
    HttpConnectionType["INTERNET"] = "INTERNET";
})(HttpConnectionType = exports.HttpConnectionType || (exports.HttpConnectionType = {}));
/**
 * Payload format version for lambda proxy integration
 * @see https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-develop-integrations-lambda.html
 */
class PayloadFormatVersion {
    constructor(version) {
        this.version = version;
    }
    /**
     * A custom payload version.
     * Typically used if there is a version number that the CDK doesn't support yet
     */
    static custom(version) {
        return new PayloadFormatVersion(version);
    }
}
exports.PayloadFormatVersion = PayloadFormatVersion;
_b = JSII_RTTI_SYMBOL_1;
PayloadFormatVersion[_b] = { fqn: "@aws-cdk/aws-apigatewayv2.PayloadFormatVersion", version: "1.159.0" };
/** Version 1.0 */
PayloadFormatVersion.VERSION_1_0 = new PayloadFormatVersion('1.0');
/** Version 2.0 */
PayloadFormatVersion.VERSION_2_0 = new PayloadFormatVersion('2.0');
/**
 * The integration for an API route.
 * @resource AWS::ApiGatewayV2::Integration
 */
class HttpIntegration extends core_1.Resource {
    constructor(scope, id, props) {
        var _e, _f, _g;
        super(scope, id);
        try {
            jsiiDeprecationWarnings._aws_cdk_aws_apigatewayv2_HttpIntegrationProps(props);
        }
        catch (error) {
            if (process.env.JSII_DEBUG !== "1" && error.name === "DeprecationError") {
                Error.captureStackTrace(error, this.constructor);
            }
            throw error;
        }
        if (!props.integrationSubtype && !props.integrationUri) {
            throw new Error('Either `integrationSubtype` or `integrationUri` must be specified.');
        }
        const integ = new apigatewayv2_generated_1.CfnIntegration(this, 'Resource', {
            apiId: props.httpApi.apiId,
            integrationType: props.integrationType,
            integrationSubtype: props.integrationSubtype,
            integrationUri: props.integrationUri,
            integrationMethod: props.method,
            connectionId: props.connectionId,
            connectionType: props.connectionType,
            payloadFormatVersion: (_e = props.payloadFormatVersion) === null || _e === void 0 ? void 0 : _e.version,
            requestParameters: (_f = props.parameterMapping) === null || _f === void 0 ? void 0 : _f.mappings,
            credentialsArn: (_g = props.credentials) === null || _g === void 0 ? void 0 : _g.credentialsArn,
        });
        if (props.secureServerName) {
            integ.tlsConfig = {
                serverNameToVerify: props.secureServerName,
            };
        }
        this.integrationId = integ.ref;
        this.httpApi = props.httpApi;
    }
}
exports.HttpIntegration = HttpIntegration;
_c = JSII_RTTI_SYMBOL_1;
HttpIntegration[_c] = { fqn: "@aws-cdk/aws-apigatewayv2.HttpIntegration", version: "1.159.0" };
/**
 * The interface that various route integration classes will inherit.
 */
class HttpRouteIntegration {
    /**
     * Initialize an integration for a route on http api.
     * @param id id of the underlying `HttpIntegration` construct.
     */
    constructor(id) {
        this.id = id;
    }
    /**
     * Internal method called when binding this integration to the route.
     * @internal
     */
    _bindToRoute(options) {
        if (this.integration && this.integration.httpApi.node.addr !== options.route.httpApi.node.addr) {
            throw new Error('A single integration cannot be associated with multiple APIs.');
        }
        if (!this.integration) {
            const config = this.bind(options);
            this.integration = new HttpIntegration(options.scope, this.id, {
                httpApi: options.route.httpApi,
                integrationType: config.type,
                integrationSubtype: config.subtype,
                integrationUri: config.uri,
                method: config.method,
                connectionId: config.connectionId,
                connectionType: config.connectionType,
                payloadFormatVersion: config.payloadFormatVersion,
                secureServerName: config.secureServerName,
                parameterMapping: config.parameterMapping,
                credentials: config.credentials,
            });
        }
        this.completeBind(options);
        return { integrationId: this.integration.integrationId };
    }
    /**
     * Complete the binding of the integration to the route. In some cases, there is
     * some additional work to do, such as adding permissions for the API to access
     * the target. This work is necessary whether the integration has just been
     * created for this route or it is an existing one, previously created for other
     * routes. In most cases, however, concrete implementations do not need to
     * override this method.
     */
    completeBind(_options) {
        try {
            jsiiDeprecationWarnings._aws_cdk_aws_apigatewayv2_HttpRouteIntegrationBindOptions(_options);
        }
        catch (error) {
            if (process.env.JSII_DEBUG !== "1" && error.name === "DeprecationError") {
                Error.captureStackTrace(error, this.completeBind);
            }
            throw error;
        }
    }
}
exports.HttpRouteIntegration = HttpRouteIntegration;
_d = JSII_RTTI_SYMBOL_1;
HttpRouteIntegration[_d] = { fqn: "@aws-cdk/aws-apigatewayv2.HttpRouteIntegration", version: "1.159.0" };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZWdyYXRpb24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbnRlZ3JhdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFDQSx3Q0FBeUM7QUFFekMsc0VBQTJEO0FBa0IzRDs7R0FFRztBQUNILElBQVksbUJBdUJYO0FBdkJELFdBQVksbUJBQW1CO0lBQzdCOzs7Ozs7OztPQVFHO0lBQ0gsZ0RBQXlCLENBQUE7SUFFekI7Ozs7Ozs7OztPQVNHO0lBQ0gsOENBQXVCLENBQUE7QUFDekIsQ0FBQyxFQXZCVyxtQkFBbUIsR0FBbkIsMkJBQW1CLEtBQW5CLDJCQUFtQixRQXVCOUI7QUFFRDs7O0dBR0c7QUFDSCxJQUFZLHNCQXlDWDtBQXpDRCxXQUFZLHNCQUFzQjtJQUNoQzs7T0FFRztJQUNILDBFQUFnRCxDQUFBO0lBQ2hEOztPQUVHO0lBQ0gsOERBQW9DLENBQUE7SUFDcEM7O09BRUc7SUFDSCxvRUFBMEMsQ0FBQTtJQUMxQzs7T0FFRztJQUNILGtFQUF3QyxDQUFBO0lBQ3hDOztPQUVHO0lBQ0gsNERBQWtDLENBQUE7SUFDbEM7O09BRUc7SUFDSCxvRkFBMEQsQ0FBQTtJQUMxRDs7T0FFRztJQUNILGtFQUF3QyxDQUFBO0lBQ3hDOztPQUVHO0lBQ0gsd0ZBQThELENBQUE7SUFDOUQ7O09BRUc7SUFDSCxpR0FBdUUsQ0FBQTtJQUN2RTs7T0FFRztJQUNILHNGQUE0RCxDQUFBO0FBQzlELENBQUMsRUF6Q1csc0JBQXNCLEdBQXRCLDhCQUFzQixLQUF0Qiw4QkFBc0IsUUF5Q2pDO0FBRUQ7O0dBRUc7QUFDSCxNQUFzQixzQkFBc0I7SUFDMUM7O09BRUc7SUFDSSxNQUFNLENBQUMsUUFBUSxDQUFDLElBQVc7UUFDaEMsT0FBTyxFQUFFLGNBQWMsRUFBRSxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7S0FDekM7SUFFRCw4REFBOEQ7SUFDdkQsTUFBTSxDQUFDLGlCQUFpQjtRQUM3QixPQUFPLEVBQUUsY0FBYyxFQUFFLHVCQUF1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QUFDO1lBRWxDLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxlQUFlLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO2dCQUM3RCxPQUFPLEVBQUUsT0FBTyxDQUFDLEtBQUssQ0FBQyxPQUFPO2dCQUM5QixlQUFlLEVBQUUsTUFBTSxDQUFDLElBQUk7Z0JBQzVCLGtCQUFrQixFQUFFLE1BQU0sQ0FBQyxPQUFPO2dCQUNsQyxjQUFjLEVBQUUsTUFBTSxDQUFDLEdBQUc7Z0JBQzFCLE1BQU0sRUFBRSxNQUFNLENBQUMsTUFBTTtnQkFDckIsWUFBWSxFQUFFLE1BQU0sQ0FBQyxZQUFZO2dCQUNqQyxjQUFjLEVBQUUsTUFBTSxDQUFDLGNBQWM7Z0JBQ3JDLG9CQUFvQixFQUFFLE1BQU0sQ0FBQyxvQkFBb0I7Z0JBQ2pELGdCQUFnQixFQUFFLE1BQU0sQ0FBQyxnQkFBZ0I7Z0JBQ3pDLGdCQUFnQixFQUFFLE1BQU0sQ0FBQyxnQkFBZ0I7Z0JBQ3pDLFdBQVcsRUFBRSxNQUFNLENBQUMsV0FBVzthQUNoQyxDQUFDLENBQUM7U0FDSjtRQUNELElBQUksQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDM0IsT0FBTyxFQUFFLGFBQWEsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLGFBQWEsRUFBRSxDQUFDO0tBQzFEO0lBRUQ7Ozs7Ozs7T0FPRztJQUNPLFlBQVksQ0FBQyxRQUF5Qzs7Ozs7Ozs7OztLQUUvRDs7QUFqREgsb0RBdURDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSVJvbGUgfSBmcm9tICdAYXdzLWNkay9hd3MtaWFtJztcbmltcG9ydCB7IFJlc291cmNlIH0gZnJvbSAnQGF3cy1jZGsvY29yZSc7XG5pbXBvcnQgeyBDb25zdHJ1Y3QgfSBmcm9tICdjb25zdHJ1Y3RzJztcbmltcG9ydCB7IENmbkludGVncmF0aW9uIH0gZnJvbSAnLi4vYXBpZ2F0ZXdheXYyLmdlbmVyYXRlZCc7XG5pbXBvcnQgeyBJSW50ZWdyYXRpb24gfSBmcm9tICcuLi9jb21tb24nO1xuaW1wb3J0IHsgUGFyYW1ldGVyTWFwcGluZyB9IGZyb20gJy4uL3BhcmFtZXRlci1tYXBwaW5nJztcbmltcG9ydCB7IElIdHRwQXBpIH0gZnJvbSAnLi9hcGknO1xuaW1wb3J0IHsgSHR0cE1ldGhvZCwgSUh0dHBSb3V0ZSB9IGZyb20gJy4vcm91dGUnO1xuXG4vLyB2MiAtIGtlZXAgdGhpcyBpbXBvcnQgYXMgYSBzZXBhcmF0ZSBzZWN0aW9uIHRvIHJlZHVjZSBtZXJnZSBjb25mbGljdCB3aGVuIGZvcndhcmQgbWVyZ2luZyB3aXRoIHRoZSB2MiBicmFuY2guXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbmltcG9ydCB7IENvbnN0cnVjdCBhcyBDb3JlQ29uc3RydWN0IH0gZnJvbSAnQGF3cy1jZGsvY29yZSc7XG5cbi8qKlxuICogUmVwcmVzZW50cyBhbiBJbnRlZ3JhdGlvbiBmb3IgYW4gSFRUUCBBUEkuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSUh0dHBJbnRlZ3JhdGlvbiBleHRlbmRzIElJbnRlZ3JhdGlvbiB7XG4gIC8qKiBUaGUgSFRUUCBBUEkgYXNzb2NpYXRlZCB3aXRoIHRoaXMgaW50ZWdyYXRpb24gKi9cbiAgcmVhZG9ubHkgaHR0cEFwaTogSUh0dHBBcGk7XG59XG5cbi8qKlxuICogU3VwcG9ydGVkIGludGVncmF0aW9uIHR5cGVzXG4gKi9cbmV4cG9ydCBlbnVtIEh0dHBJbnRlZ3JhdGlvblR5cGUge1xuICAvKipcbiAgICogSW50ZWdyYXRpb24gdHlwZSBpcyBhbiBIVFRQIHByb3h5LlxuICAgKlxuICAgKiBGb3IgaW50ZWdyYXRpbmcgdGhlIHJvdXRlIG9yIG1ldGhvZCByZXF1ZXN0IHdpdGggYW4gSFRUUCBlbmRwb2ludCwgd2l0aCB0aGVcbiAgICogY2xpZW50IHJlcXVlc3QgcGFzc2VkIHRocm91Z2ggYXMtaXMuIFRoaXMgaXMgYWxzbyByZWZlcnJlZCB0byBhcyBIVFRQIHByb3h5XG4gICAqIGludGVncmF0aW9uLiBGb3IgSFRUUCBBUEkgcHJpdmF0ZSBpbnRlZ3JhdGlvbnMsIHVzZSBhbiBIVFRQX1BST1hZIGludGVncmF0aW9uLlxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vZG9jcy5hd3MuYW1hem9uLmNvbS9hcGlnYXRld2F5L2xhdGVzdC9kZXZlbG9wZXJndWlkZS9odHRwLWFwaS1kZXZlbG9wLWludGVncmF0aW9ucy1odHRwLmh0bWxcbiAgICovXG4gIEhUVFBfUFJPWFkgPSAnSFRUUF9QUk9YWScsXG5cbiAgLyoqXG4gICAqIEludGVncmF0aW9uIHR5cGUgaXMgYW4gQVdTIHByb3h5LlxuICAgKlxuICAgKiBGb3IgaW50ZWdyYXRpbmcgdGhlIHJvdXRlIG9yIG1ldGhvZCByZXF1ZXN0IHdpdGggYSBMYW1iZGEgZnVuY3Rpb24gb3Igb3RoZXJcbiAgICogQVdTIHNlcnZpY2UgYWN0aW9uLiBUaGlzIGludGVncmF0aW9uIGlzIGFsc28gcmVmZXJyZWQgdG8gYXMgYSBMYW1iZGEgcHJveHlcbiAgICogaW50ZWdyYXRpb24uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly9kb2NzLmF3cy5hbWF6b24uY29tL2FwaWdhdGV3YXkvbGF0ZXN0L2RldmVsb3Blcmd1aWRlL2h0dHAtYXBpLWRldmVsb3AtaW50ZWdyYXRpb25zLWF3cy1zZXJ2aWNlcy5odG1sXG4gICAqIEBzZWUgaHR0cHM6Ly9kb2NzLmF3cy5hbWF6b24uY29tL2FwaWdhdGV3YXkvbGF0ZXN0L2RldmVsb3Blcmd1aWRlL2h0dHAtYXBpLWRldmVsb3AtaW50ZWdyYXRpb25zLWxhbWJkYS5odG1sXG4gICAqL1xuICBBV1NfUFJPWFkgPSAnQVdTX1BST1hZJyxcbn1cblxuLyoqXG4gKiBTdXBwb3J0ZWQgaW50ZWdyYXRpb24gc3VidHlwZXNcbiAqIEBzZWUgaHR0cHM6Ly9kb2NzLmF3cy5hbWF6b24uY29tL2FwaWdhdGV3YXkvbGF0ZXN0L2RldmVsb3Blcmd1aWRlL2h0dHAtYXBpLWRldmVsb3AtaW50ZWdyYXRpb25zLWF3cy1zZXJ2aWNlcy1yZWZlcmVuY2UuaHRtbFxuICovXG5leHBvcnQgZW51bSBIdHRwSW50ZWdyYXRpb25TdWJ0eXBlIHtcbiAgLyoqXG4gICAqIEV2ZW50QnJpZGdlIFB1dEV2ZW50cyBpbnRlZ3JhdGlvblxuICAgKi9cbiAgRVZFTlRCUklER0VfUFVUX0VWRU5UUyA9ICdFdmVudEJyaWRnZS1QdXRFdmVudHMnLFxuICAvKipcbiAgICogU1FTIFNlbmRNZXNzYWdlIGludGVncmF0aW9uXG4gICAqL1xuICBTUVNfU0VORF9NRVNTQUdFID0gJ1NRUy1TZW5kTWVzc2FnZScsXG4gIC8qKlxuICAgKiBTUVMgUmVjZWl2ZU1lc3NhZ2UgaW50ZWdyYXRpb24sXG4gICAqL1xuICBTUVNfUkVDRUlWRV9NRVNTQUdFID0gJ1NRUy1SZWNlaXZlTWVzc2FnZScsXG4gIC8qKlxuICAgKiBTUVMgRGVsZXRlTWVzc2FnZSBpbnRlZ3JhdGlvbixcbiAgICovXG4gIFNRU19ERUxFVEVfTUVTU0FHRSA9ICdTUVMtRGVsZXRlTWVzc2FnZScsXG4gIC8qKlxuICAgKiBTUVMgUHVyZ2VRdWV1ZSBpbnRlZ3JhdGlvblxuICAgKi9cbiAgU1FTX1BVUkdFX1FVRVVFID0gJ1NRUy1QdXJnZVF1ZXVlJyxcbiAgLyoqXG4gICAqIEFwcENvbmZpZyBHZXRDb25maWd1cmF0aW9uIGludGVncmF0aW9uXG4gICAqL1xuICBBUFBDT05GSUdfR0VUX0NPTkZJR1VSQVRJT04gPSAnQXBwQ29uZmlnLUdldENvbmZpZ3VyYXRpb24nLFxuICAvKipcbiAgICogS2luZXNpcyBQdXRSZWNvcmQgaW50ZWdyYXRpb25cbiAgICovXG4gIEtJTkVTSVNfUFVUX1JFQ09SRCA9ICdLaW5lc2lzLVB1dFJlY29yZCcsXG4gIC8qKlxuICAgKiBTdGVwIEZ1bmN0aW9ucyBTdGFydEV4ZWN1dGlvbiBpbnRlZ3JhdGlvblxuICAgKi9cbiAgU1RFUEZVTkNUSU9OU19TVEFSVF9FWEVDVVRJT04gPSAnU3RlcEZ1bmN0aW9ucy1TdGFydEV4ZWN1dGlvbicsXG4gIC8qKlxuICAgKiBTdGVwIEZ1bmN0aW9ucyBTdGFydFN5bmNFeGVjdXRpb24gaW50ZWdyYXRpb25cbiAgICovXG4gIFNURVBGVU5DVElPTlNfU1RBUlRfU1lOQ19FWEVDVVRJT04gPSAnU3RlcEZ1bmN0aW9ucy1TdGFydFN5bmNFeGVjdXRpb24nLFxuICAvKipcbiAgICogU3RlcCBGdW5jdGlvbnMgU3RvcEV4ZWN1dGlvbiBpbnRlZ3JhdGlvblxuICAgKi9cbiAgU1RFUEZVTkNUSU9OU19TVE9QX0VYRUNVVElPTiA9ICdTdGVwRnVuY3Rpb25zLVN0b3BFeGVjdXRpb24nLFxufVxuXG4vKipcbiAqIENyZWRlbnRpYWxzIHVzZWQgZm9yIEFXUyBTZXJ2aWNlIGludGVncmF0aW9ucy5cbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEludGVncmF0aW9uQ3JlZGVudGlhbHMge1xuICAvKipcbiAgICogVXNlIHRoZSBzcGVjaWZpZWQgcm9sZSBmb3IgaW50ZWdyYXRpb24gcmVxdWVzdHNcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZnJvbVJvbGUocm9sZTogSVJvbGUpOiBJbnRlZ3JhdGlvbkNyZWRlbnRpYWxzIHtcbiAgICByZXR1cm4geyBjcmVkZW50aWFsc0Fybjogcm9sZS5yb2xlQXJuIH07XG4gIH1cblxuICAvKiogVXNlIHRoZSBjYWxsaW5nIHVzZXIncyBpZGVudGl0eSB0byBjYWxsIHRoZSBpbnRlZ3JhdGlvbiAqL1xuICBwdWJsaWMgc3RhdGljIHVzZUNhbGxlcklkZW50aXR5KCk6IEludGVncmF0aW9uQ3JlZGVudGlhbHMge1xuICAgIHJldHVybiB7IGNyZWRlbnRpYWxzQXJuOiAnYXJuOmF3czppYW06Oio6dXNlci8qJyB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBBUk4gb2YgdGhlIGNyZWRlbnRpYWxzXG4gICAqL1xuICBwdWJsaWMgYWJzdHJhY3QgcmVhZG9ubHkgY3JlZGVudGlhbHNBcm46IHN0cmluZztcbn1cblxuLyoqXG4gKiBTdXBwb3J0ZWQgY29ubmVjdGlvbiB0eXBlc1xuICovXG5leHBvcnQgZW51bSBIdHRwQ29ubmVjdGlvblR5cGUge1xuICAvKipcbiAgICogRm9yIHByaXZhdGUgY29ubmVjdGlvbnMgYmV0d2VlbiBBUEkgR2F0ZXdheSBhbmQgcmVzb3VyY2VzIGluIGEgVlBDXG4gICAqL1xuICBWUENfTElOSyA9ICdWUENfTElOSycsXG4gIC8qKlxuICAgKiBGb3IgY29ubmVjdGlvbnMgdGhyb3VnaCBwdWJsaWMgcm91dGFibGUgaW50ZXJuZXRcbiAgICovXG4gIElOVEVSTkVUID0gJ0lOVEVSTkVUJyxcbn1cblxuLyoqXG4gKiBQYXlsb2FkIGZvcm1hdCB2ZXJzaW9uIGZvciBsYW1iZGEgcHJveHkgaW50ZWdyYXRpb25cbiAqIEBzZWUgaHR0cHM6Ly9kb2NzLmF3cy5hbWF6b24uY29tL2FwaWdhdGV3YXkvbGF0ZXN0L2RldmVsb3Blcmd1aWRlL2h0dHAtYXBpLWRldmVsb3AtaW50ZWdyYXRpb25zLWxhbWJkYS5odG1sXG4gKi9cbmV4cG9ydCBjbGFzcyBQYXlsb2FkRm9ybWF0VmVyc2lvbiB7XG4gIC8qKiBWZXJzaW9uIDEuMCAqL1xuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFZFUlNJT05fMV8wID0gbmV3IFBheWxvYWRGb3JtYXRWZXJzaW9uKCcxLjAnKTtcbiAgLyoqIFZlcnNpb24gMi4wICovXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgVkVSU0lPTl8yXzAgPSBuZXcgUGF5bG9hZEZvcm1hdFZlcnNpb24oJzIuMCcpO1xuXG4gIC8qKlxuICAgKiBBIGN1c3RvbSBwYXlsb2FkIHZlcnNpb24uXG4gICAqIFR5cGljYWxseSB1c2VkIGlmIHRoZXJlIGlzIGEgdmVyc2lvbiBudW1iZXIgdGhhdCB0aGUgQ0RLIGRvZXNuJ3Qgc3VwcG9ydCB5ZXRcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgY3VzdG9tKHZlcnNpb246IHN0cmluZykge1xuICAgIHJldHVybiBuZXcgUGF5bG9hZEZvcm1hdFZlcnNpb24odmVyc2lvbik7XG4gIH1cblxuICAvKiogdmVyc2lvbiBhcyBhIHN0cmluZyAqL1xuICBwdWJsaWMgcmVhZG9ubHkgdmVyc2lvbjogc3RyaW5nO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IodmVyc2lvbjogc3RyaW5nKSB7XG4gICAgdGhpcy52ZXJzaW9uID0gdmVyc2lvbjtcbiAgfVxufVxuXG4vKipcbiAqIFRoZSBpbnRlZ3JhdGlvbiBwcm9wZXJ0aWVzXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSHR0cEludGVncmF0aW9uUHJvcHMge1xuICAvKipcbiAgICogVGhlIEhUVFAgQVBJIHRvIHdoaWNoIHRoaXMgaW50ZWdyYXRpb24gc2hvdWxkIGJlIGJvdW5kLlxuICAgKi9cbiAgcmVhZG9ubHkgaHR0cEFwaTogSUh0dHBBcGk7XG5cbiAgLyoqXG4gICAqIEludGVncmF0aW9uIHR5cGVcbiAgICovXG4gIHJlYWRvbmx5IGludGVncmF0aW9uVHlwZTogSHR0cEludGVncmF0aW9uVHlwZTtcblxuICAvKipcbiAgICogSW50ZWdyYXRpb24gc3VidHlwZS5cbiAgICpcbiAgICogVXNlZCBmb3IgQVdTIFNlcnZpY2UgaW50ZWdyYXRpb25zLCBzcGVjaWZpZXMgdGhlIHRhcmdldCBvZiB0aGUgaW50ZWdyYXRpb24uXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gbm9uZSwgcmVxdWlyZWQgaWYgbm8gYGludGVncmF0aW9uVXJpYCBpcyBkZWZpbmVkLlxuICAgKi9cbiAgcmVhZG9ubHkgaW50ZWdyYXRpb25TdWJ0eXBlPzogSHR0cEludGVncmF0aW9uU3VidHlwZTtcblxuICAvKipcbiAgICogSW50ZWdyYXRpb24gVVJJLlxuICAgKiBUaGlzIHdpbGwgYmUgdGhlIGZ1bmN0aW9uIEFSTiBpbiB0aGUgY2FzZSBvZiBgSHR0cEludGVncmF0aW9uVHlwZS5BV1NfUFJPWFlgLFxuICAgKiBvciBIVFRQIFVSTCBpbiB0aGUgY2FzZSBvZiBgSHR0cEludGVncmF0aW9uVHlwZS5IVFRQX1BST1hZYC5cbiAgICpcbiAgICogQGRlZmF1bHQgLSBub25lLCByZXF1aXJlZCBpZiBubyBgaW50ZWdyYXRpb25TdWJ0eXBlYCBpcyBkZWZpbmVkLlxuICAgKi9cbiAgcmVhZG9ubHkgaW50ZWdyYXRpb25Vcmk/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBIVFRQIG1ldGhvZCB0byB1c2Ugd2hlbiBjYWxsaW5nIHRoZSB1bmRlcmx5aW5nIEhUVFAgcHJveHlcbiAgICogQGRlZmF1bHQgLSBub25lLiByZXF1aXJlZCBpZiB0aGUgaW50ZWdyYXRpb24gdHlwZSBpcyBgSHR0cEludGVncmF0aW9uVHlwZS5IVFRQX1BST1hZYC5cbiAgICovXG4gIHJlYWRvbmx5IG1ldGhvZD86IEh0dHBNZXRob2Q7XG5cbiAgLyoqXG4gICAqIFRoZSBJRCBvZiB0aGUgVlBDIGxpbmsgZm9yIGEgcHJpdmF0ZSBpbnRlZ3JhdGlvbi4gU3VwcG9ydGVkIG9ubHkgZm9yIEhUVFAgQVBJcy5cbiAgICpcbiAgICogQGRlZmF1bHQgLSB1bmRlZmluZWRcbiAgICovXG4gIHJlYWRvbmx5IGNvbm5lY3Rpb25JZD86IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIHR5cGUgb2YgdGhlIG5ldHdvcmsgY29ubmVjdGlvbiB0byB0aGUgaW50ZWdyYXRpb24gZW5kcG9pbnRcbiAgICpcbiAgICogQGRlZmF1bHQgSHR0cENvbm5lY3Rpb25UeXBlLklOVEVSTkVUXG4gICAqL1xuICByZWFkb25seSBjb25uZWN0aW9uVHlwZT86IEh0dHBDb25uZWN0aW9uVHlwZTtcblxuICAvKipcbiAgICogVGhlIHZlcnNpb24gb2YgdGhlIHBheWxvYWQgZm9ybWF0XG4gICAqIEBzZWUgaHR0cHM6Ly9kb2NzLmF3cy5hbWF6b24uY29tL2FwaWdhdGV3YXkvbGF0ZXN0L2RldmVsb3Blcmd1aWRlL2h0dHAtYXBpLWRldmVsb3AtaW50ZWdyYXRpb25zLWxhbWJkYS5odG1sXG4gICAqIEBkZWZhdWx0IC0gZGVmYXVsdHMgdG8gbGF0ZXN0IGluIHRoZSBjYXNlIG9mIEh0dHBJbnRlZ3JhdGlvblR5cGUuQVdTX1BST1hZYCwgaXJyZWxldmFudCBvdGhlcndpc2UuXG4gICAqL1xuICByZWFkb25seSBwYXlsb2FkRm9ybWF0VmVyc2lvbj86IFBheWxvYWRGb3JtYXRWZXJzaW9uO1xuXG4gIC8qKlxuICAgKiBTcGVjaWZpZXMgdGhlIFRMUyBjb25maWd1cmF0aW9uIGZvciBhIHByaXZhdGUgaW50ZWdyYXRpb25cbiAgICogQHNlZSBodHRwczovL2RvY3MuYXdzLmFtYXpvbi5jb20vQVdTQ2xvdWRGb3JtYXRpb24vbGF0ZXN0L1VzZXJHdWlkZS9hd3MtcHJvcGVydGllcy1hcGlnYXRld2F5djItaW50ZWdyYXRpb24tdGxzY29uZmlnLmh0bWxcbiAgICogQGRlZmF1bHQgdW5kZWZpbmVkIHByaXZhdGUgaW50ZWdyYXRpb24gdHJhZmZpYyB3aWxsIHVzZSBIVFRQIHByb3RvY29sXG4gICAqL1xuICByZWFkb25seSBzZWN1cmVTZXJ2ZXJOYW1lPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBTcGVjaWZpZXMgaG93IHRvIHRyYW5zZm9ybSBIVFRQIHJlcXVlc3RzIGJlZm9yZSBzZW5kaW5nIHRoZW0gdG8gdGhlIGJhY2tlbmRcbiAgICogQHNlZSBodHRwczovL2RvY3MuYXdzLmFtYXpvbi5jb20vYXBpZ2F0ZXdheS9sYXRlc3QvZGV2ZWxvcGVyZ3VpZGUvaHR0cC1hcGktcGFyYW1ldGVyLW1hcHBpbmcuaHRtbFxuICAgKiBAZGVmYXVsdCB1bmRlZmluZWQgcmVxdWVzdHMgYXJlIHNlbnQgdG8gdGhlIGJhY2tlbmQgdW5tb2RpZmllZFxuICAgKi9cbiAgcmVhZG9ubHkgcGFyYW1ldGVyTWFwcGluZz86IFBhcmFtZXRlck1hcHBpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBjcmVkZW50aWFscyB3aXRoIHdoaWNoIHRvIGludm9rZSB0aGUgaW50ZWdyYXRpb24uXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gbm8gY3JlZGVudGlhbHMsIHVzZSByZXNvdXJjZS1iYXNlZCBwZXJtaXNzaW9ucyBvbiBzdXBwb3J0ZWQgQVdTIHNlcnZpY2VzXG4gICAqL1xuICByZWFkb25seSBjcmVkZW50aWFscz86IEludGVncmF0aW9uQ3JlZGVudGlhbHM7XG59XG5cbi8qKlxuICogVGhlIGludGVncmF0aW9uIGZvciBhbiBBUEkgcm91dGUuXG4gKiBAcmVzb3VyY2UgQVdTOjpBcGlHYXRld2F5VjI6OkludGVncmF0aW9uXG4gKi9cbmV4cG9ydCBjbGFzcyBIdHRwSW50ZWdyYXRpb24gZXh0ZW5kcyBSZXNvdXJjZSBpbXBsZW1lbnRzIElIdHRwSW50ZWdyYXRpb24ge1xuICBwdWJsaWMgcmVhZG9ubHkgaW50ZWdyYXRpb25JZDogc3RyaW5nO1xuXG4gIHB1YmxpYyByZWFkb25seSBodHRwQXBpOiBJSHR0cEFwaTtcblxuICBjb25zdHJ1Y3RvcihzY29wZTogQ29uc3RydWN0LCBpZDogc3RyaW5nLCBwcm9wczogSHR0cEludGVncmF0aW9uUHJvcHMpIHtcbiAgICBzdXBlcihzY29wZSwgaWQpO1xuXG4gICAgaWYgKCFwcm9wcy5pbnRlZ3JhdGlvblN1YnR5cGUgJiYgIXByb3BzLmludGVncmF0aW9uVXJpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0VpdGhlciBgaW50ZWdyYXRpb25TdWJ0eXBlYCBvciBgaW50ZWdyYXRpb25VcmlgIG11c3QgYmUgc3BlY2lmaWVkLicpO1xuICAgIH1cblxuICAgIGNvbnN0IGludGVnID0gbmV3IENmbkludGVncmF0aW9uKHRoaXMsICdSZXNvdXJjZScsIHtcbiAgICAgIGFwaUlkOiBwcm9wcy5odHRwQXBpLmFwaUlkLFxuICAgICAgaW50ZWdyYXRpb25UeXBlOiBwcm9wcy5pbnRlZ3JhdGlvblR5cGUsXG4gICAgICBpbnRlZ3JhdGlvblN1YnR5cGU6IHByb3BzLmludGVncmF0aW9uU3VidHlwZSxcbiAgICAgIGludGVncmF0aW9uVXJpOiBwcm9wcy5pbnRlZ3JhdGlvblVyaSxcbiAgICAgIGludGVncmF0aW9uTWV0aG9kOiBwcm9wcy5tZXRob2QsXG4gICAgICBjb25uZWN0aW9uSWQ6IHByb3BzLmNvbm5lY3Rpb25JZCxcbiAgICAgIGNvbm5lY3Rpb25UeXBlOiBwcm9wcy5jb25uZWN0aW9uVHlwZSxcbiAgICAgIHBheWxvYWRGb3JtYXRWZXJzaW9uOiBwcm9wcy5wYXlsb2FkRm9ybWF0VmVyc2lvbj8udmVyc2lvbixcbiAgICAgIHJlcXVlc3RQYXJhbWV0ZXJzOiBwcm9wcy5wYXJhbWV0ZXJNYXBwaW5nPy5tYXBwaW5ncyxcbiAgICAgIGNyZWRlbnRpYWxzQXJuOiBwcm9wcy5jcmVkZW50aWFscz8uY3JlZGVudGlhbHNBcm4sXG4gICAgfSk7XG5cbiAgICBpZiAocHJvcHMuc2VjdXJlU2VydmVyTmFtZSkge1xuICAgICAgaW50ZWcudGxzQ29uZmlnID0ge1xuICAgICAgICBzZXJ2ZXJOYW1lVG9WZXJpZnk6IHByb3BzLnNlY3VyZVNlcnZlck5hbWUsXG4gICAgICB9O1xuICAgIH1cblxuICAgIHRoaXMuaW50ZWdyYXRpb25JZCA9IGludGVnLnJlZjtcbiAgICB0aGlzLmh0dHBBcGkgPSBwcm9wcy5odHRwQXBpO1xuICB9XG59XG5cbi8qKlxuICogT3B0aW9ucyB0byB0aGUgSHR0cFJvdXRlSW50ZWdyYXRpb24gZHVyaW5nIGl0cyBiaW5kIG9wZXJhdGlvbi5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBIdHRwUm91dGVJbnRlZ3JhdGlvbkJpbmRPcHRpb25zIHtcbiAgLyoqXG4gICAqIFRoZSByb3V0ZSB0byB3aGljaCB0aGlzIGlzIGJlaW5nIGJvdW5kLlxuICAgKi9cbiAgcmVhZG9ubHkgcm91dGU6IElIdHRwUm91dGU7XG5cbiAgLyoqXG4gICAqIFRoZSBjdXJyZW50IHNjb3BlIGluIHdoaWNoIHRoZSBiaW5kIGlzIG9jY3VycmluZy5cbiAgICogSWYgdGhlIGBIdHRwUm91dGVJbnRlZ3JhdGlvbmAgYmVpbmcgYm91bmQgY3JlYXRlcyBhZGRpdGlvbmFsIGNvbnN0cnVjdHMsXG4gICAqIHRoaXMgd2lsbCBiZSB1c2VkIGFzIHRoZWlyIHBhcmVudCBzY29wZS5cbiAgICovXG4gIHJlYWRvbmx5IHNjb3BlOiBDb3JlQ29uc3RydWN0O1xufVxuXG4vKipcbiAqIFRoZSBpbnRlcmZhY2UgdGhhdCB2YXJpb3VzIHJvdXRlIGludGVncmF0aW9uIGNsYXNzZXMgd2lsbCBpbmhlcml0LlxuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgSHR0cFJvdXRlSW50ZWdyYXRpb24ge1xuICBwcml2YXRlIGludGVncmF0aW9uPzogSHR0cEludGVncmF0aW9uO1xuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIGFuIGludGVncmF0aW9uIGZvciBhIHJvdXRlIG9uIGh0dHAgYXBpLlxuICAgKiBAcGFyYW0gaWQgaWQgb2YgdGhlIHVuZGVybHlpbmcgYEh0dHBJbnRlZ3JhdGlvbmAgY29uc3RydWN0LlxuICAgKi9cbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBpZDogc3RyaW5nKSB7fVxuXG4gIC8qKlxuICAgKiBJbnRlcm5hbCBtZXRob2QgY2FsbGVkIHdoZW4gYmluZGluZyB0aGlzIGludGVncmF0aW9uIHRvIHRoZSByb3V0ZS5cbiAgICogQGludGVybmFsXG4gICAqL1xuICBwdWJsaWMgX2JpbmRUb1JvdXRlKG9wdGlvbnM6IEh0dHBSb3V0ZUludGVncmF0aW9uQmluZE9wdGlvbnMpOiB7IHJlYWRvbmx5IGludGVncmF0aW9uSWQ6IHN0cmluZyB9IHtcbiAgICBpZiAodGhpcy5pbnRlZ3JhdGlvbiAmJiB0aGlzLmludGVncmF0aW9uLmh0dHBBcGkubm9kZS5hZGRyICE9PSBvcHRpb25zLnJvdXRlLmh0dHBBcGkubm9kZS5hZGRyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Egc2luZ2xlIGludGVncmF0aW9uIGNhbm5vdCBiZSBhc3NvY2lhdGVkIHdpdGggbXVsdGlwbGUgQVBJcy4nKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuaW50ZWdyYXRpb24pIHtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IHRoaXMuYmluZChvcHRpb25zKTtcblxuICAgICAgdGhpcy5pbnRlZ3JhdGlvbiA9IG5ldyBIdHRwSW50ZWdyYXRpb24ob3B0aW9ucy5zY29wZSwgdGhpcy5pZCwge1xuICAgICAgICBodHRwQXBpOiBvcHRpb25zLnJvdXRlLmh0dHBBcGksXG4gICAgICAgIGludGVncmF0aW9uVHlwZTogY29uZmlnLnR5cGUsXG4gICAgICAgIGludGVncmF0aW9uU3VidHlwZTogY29uZmlnLnN1YnR5cGUsXG4gICAgICAgIGludGVncmF0aW9uVXJpOiBjb25maWcudXJpLFxuICAgICAgICBtZXRob2Q6IGNvbmZpZy5tZXRob2QsXG4gICAgICAgIGNvbm5lY3Rpb25JZDogY29uZmlnLmNvbm5lY3Rpb25JZCxcbiAgICAgICAgY29ubmVjdGlvblR5cGU6IGNvbmZpZy5jb25uZWN0aW9uVHlwZSxcbiAgICAgICAgcGF5bG9hZEZvcm1hdFZlcnNpb246IGNvbmZpZy5wYXlsb2FkRm9ybWF0VmVyc2lvbixcbiAgICAgICAgc2VjdXJlU2VydmVyTmFtZTogY29uZmlnLnNlY3VyZVNlcnZlck5hbWUsXG4gICAgICAgIHBhcmFtZXRlck1hcHBpbmc6IGNvbmZpZy5wYXJhbWV0ZXJNYXBwaW5nLFxuICAgICAgICBjcmVkZW50aWFsczogY29uZmlnLmNyZWRlbnRpYWxzLFxuICAgICAgfSk7XG4gICAgfVxuICAgIHRoaXMuY29tcGxldGVCaW5kKG9wdGlvbnMpO1xuICAgIHJldHVybiB7IGludGVncmF0aW9uSWQ6IHRoaXMuaW50ZWdyYXRpb24uaW50ZWdyYXRpb25JZCB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENvbXBsZXRlIHRoZSBiaW5kaW5nIG9mIHRoZSBpbnRlZ3JhdGlvbiB0byB0aGUgcm91dGUuIEluIHNvbWUgY2FzZXMsIHRoZXJlIGlzXG4gICAqIHNvbWUgYWRkaXRpb25hbCB3b3JrIHRvIGRvLCBzdWNoIGFzIGFkZGluZyBwZXJtaXNzaW9ucyBmb3IgdGhlIEFQSSB0byBhY2Nlc3NcbiAgICogdGhlIHRhcmdldC4gVGhpcyB3b3JrIGlzIG5lY2Vzc2FyeSB3aGV0aGVyIHRoZSBpbnRlZ3JhdGlvbiBoYXMganVzdCBiZWVuXG4gICAqIGNyZWF0ZWQgZm9yIHRoaXMgcm91dGUgb3IgaXQgaXMgYW4gZXhpc3Rpbmcgb25lLCBwcmV2aW91c2x5IGNyZWF0ZWQgZm9yIG90aGVyXG4gICAqIHJvdXRlcy4gSW4gbW9zdCBjYXNlcywgaG93ZXZlciwgY29uY3JldGUgaW1wbGVtZW50YXRpb25zIGRvIG5vdCBuZWVkIHRvXG4gICAqIG92ZXJyaWRlIHRoaXMgbWV0aG9kLlxuICAgKi9cbiAgcHJvdGVjdGVkIGNvbXBsZXRlQmluZChfb3B0aW9uczogSHR0cFJvdXRlSW50ZWdyYXRpb25CaW5kT3B0aW9ucyk6IHZvaWQge1xuICAgIC8vIG5vLW9wIGJ5IGRlZmF1bHRcbiAgfVxuXG4gIC8qKlxuICAgKiBCaW5kIHRoaXMgaW50ZWdyYXRpb24gdG8gdGhlIHJvdXRlLlxuICAgKi9cbiAgcHVibGljIGFic3RyYWN0IGJpbmQob3B0aW9uczogSHR0cFJvdXRlSW50ZWdyYXRpb25CaW5kT3B0aW9ucyk6IEh0dHBSb3V0ZUludGVncmF0aW9uQ29uZmlnO1xufVxuXG4vKipcbiAqIENvbmZpZyByZXR1cm5lZCBiYWNrIGFzIGEgcmVzdWx0IG9mIHRoZSBiaW5kLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIEh0dHBSb3V0ZUludGVncmF0aW9uQ29uZmlnIHtcbiAgLyoqXG4gICAqIEludGVncmF0aW9uIHR5cGUuXG4gICAqL1xuICByZWFkb25seSB0eXBlOiBIdHRwSW50ZWdyYXRpb25UeXBlO1xuXG4gIC8qKlxuICAgKiBJbnRlZ3JhdGlvbiBzdWJ0eXBlLlxuICAgKlxuICAgKiBAZGVmYXVsdCAtIG5vbmUsIHJlcXVpcmVkIGlmIG5vIGBpbnRlZ3JhdGlvblVyaWAgaXMgZGVmaW5lZC5cbiAgICovXG4gIHJlYWRvbmx5IHN1YnR5cGU/OiBIdHRwSW50ZWdyYXRpb25TdWJ0eXBlO1xuXG4gIC8qKlxuICAgKiBJbnRlZ3JhdGlvbiBVUklcbiAgICpcbiAgICogQGRlZmF1bHQgLSBub25lLCByZXF1aXJlZCBpZiBubyBgaW50ZWdyYXRpb25TdWJ0eXBlYCBpcyBkZWZpbmVkLlxuICAgKi9cbiAgcmVhZG9ubHkgdXJpPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgSFRUUCBtZXRob2QgdGhhdCBtdXN0IGJlIHVzZWQgdG8gaW52b2tlIHRoZSB1bmRlcmx5aW5nIHByb3h5LlxuICAgKiBSZXF1aXJlZCBmb3IgYEh0dHBJbnRlZ3JhdGlvblR5cGUuSFRUUF9QUk9YWWBcbiAgICogQGRlZmF1bHQgLSB1bmRlZmluZWRcbiAgICovXG4gIHJlYWRvbmx5IG1ldGhvZD86IEh0dHBNZXRob2Q7XG5cbiAgLyoqXG4gICAqIFRoZSBJRCBvZiB0aGUgVlBDIGxpbmsgZm9yIGEgcHJpdmF0ZSBpbnRlZ3JhdGlvbi4gU3VwcG9ydGVkIG9ubHkgZm9yIEhUVFAgQVBJcy5cbiAgICpcbiAgICogQGRlZmF1bHQgLSB1bmRlZmluZWRcbiAgICovXG4gIHJlYWRvbmx5IGNvbm5lY3Rpb25JZD86IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIHR5cGUgb2YgdGhlIG5ldHdvcmsgY29ubmVjdGlvbiB0byB0aGUgaW50ZWdyYXRpb24gZW5kcG9pbnRcbiAgICpcbiAgICogQGRlZmF1bHQgSHR0cENvbm5lY3Rpb25UeXBlLklOVEVSTkVUXG4gICAqL1xuICByZWFkb25seSBjb25uZWN0aW9uVHlwZT86IEh0dHBDb25uZWN0aW9uVHlwZTtcblxuICAvKipcbiAgICogUGF5bG9hZCBmb3JtYXQgdmVyc2lvbiBpbiB0aGUgY2FzZSBvZiBsYW1iZGEgcHJveHkgaW50ZWdyYXRpb25cbiAgICogQHNlZSBodHRwczovL2RvY3MuYXdzLmFtYXpvbi5jb20vYXBpZ2F0ZXdheS9sYXRlc3QvZGV2ZWxvcGVyZ3VpZGUvaHR0cC1hcGktZGV2ZWxvcC1pbnRlZ3JhdGlvbnMtbGFtYmRhLmh0bWxcbiAgICogQGRlZmF1bHQgLSB1bmRlZmluZWRcbiAgICovXG4gIHJlYWRvbmx5IHBheWxvYWRGb3JtYXRWZXJzaW9uOiBQYXlsb2FkRm9ybWF0VmVyc2lvbjtcblxuICAvKipcbiAgICogU3BlY2lmaWVzIHRoZSBzZXJ2ZXIgbmFtZSB0byB2ZXJpZmllZCBieSBIVFRQUyB3aGVuIGNhbGxpbmcgdGhlIGJhY2tlbmQgaW50ZWdyYXRpb25cbiAgICogQHNlZSBodHRwczovL2RvY3MuYXdzLmFtYXpvbi5jb20vQVdTQ2xvdWRGb3JtYXRpb24vbGF0ZXN0L1VzZXJHdWlkZS9hd3MtcHJvcGVydGllcy1hcGlnYXRld2F5djItaW50ZWdyYXRpb24tdGxzY29uZmlnLmh0bWxcbiAgICogQGRlZmF1bHQgdW5kZWZpbmVkIHByaXZhdGUgaW50ZWdyYXRpb24gdHJhZmZpYyB3aWxsIHVzZSBIVFRQIHByb3RvY29sXG4gICAqL1xuICByZWFkb25seSBzZWN1cmVTZXJ2ZXJOYW1lPzogc3RyaW5nO1xuXG4gIC8qKlxuICAqIFNwZWNpZmllcyBob3cgdG8gdHJhbnNmb3JtIEhUVFAgcmVxdWVzdHMgYmVmb3JlIHNlbmRpbmcgdGhlbSB0byB0aGUgYmFja2VuZFxuICAqIEBzZWUgaHR0cHM6Ly9kb2NzLmF3cy5hbWF6b24uY29tL2FwaWdhdGV3YXkvbGF0ZXN0L2RldmVsb3Blcmd1aWRlL2h0dHAtYXBpLXBhcmFtZXRlci1tYXBwaW5nLmh0bWxcbiAgKiBAZGVmYXVsdCB1bmRlZmluZWQgcmVxdWVzdHMgYXJlIHNlbnQgdG8gdGhlIGJhY2tlbmQgdW5tb2RpZmllZFxuICAqL1xuICByZWFkb25seSBwYXJhbWV0ZXJNYXBwaW5nPzogUGFyYW1ldGVyTWFwcGluZztcblxuICAvKipcbiAgICogVGhlIGNyZWRlbnRpYWxzIHdpdGggd2hpY2ggdG8gaW52b2tlIHRoZSBpbnRlZ3JhdGlvbi5cbiAgICpcbiAgICogQGRlZmF1bHQgLSBubyBjcmVkZW50aWFscywgdXNlIHJlc291cmNlLWJhc2VkIHBlcm1pc3Npb25zIG9uIHN1cHBvcnRlZCBBV1Mgc2VydmljZXNcbiAgICovXG4gIHJlYWRvbmx5IGNyZWRlbnRpYWxzPzogSW50ZWdyYXRpb25DcmVkZW50aWFscztcbn1cbiJdfQ==